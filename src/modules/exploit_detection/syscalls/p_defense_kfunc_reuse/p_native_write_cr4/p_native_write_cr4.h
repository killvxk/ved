#if defined(CONFIG_X86)

#ifndef P_LKRG_EXPLOIT_DETECTION_NATIVE_WRITE_CR4_H
#define P_LKRG_EXPLOIT_DETECTION_NATIVE_WRITE_CR4_H

/* per-instance private data */
struct p_native_write_cr4_data {
    ktime_t entry_stamp;
};


int p_native_write_cr4_ret(struct kretprobe_instance *p_ri, struct pt_regs *p_regs);
int p_native_write_cr4_entry(struct kretprobe_instance *p_ri, struct pt_regs *p_regs);
int p_install_native_write_cr4_hook(int p_isra);
void p_uninstall_native_write_cr4_hook(void);
u32 p_get_native_write_cr4_flags(void);

#endif

#endif
